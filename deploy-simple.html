<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BuildAI Event Tracker</title>
  
  <!-- Supabase credentials -->
  <meta name="supabase-url" content="https://ofqtgjzmbncmnkumybzb.supabase.co">
  <meta name="supabase-key" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mcXRnanptYm5jbW5rdW15YnpiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5NTMwNzYsImV4cCI6MjA3MDUyOTA3Nn0.35Aw-94WlR438UVT28qv54ppgvbgmlMgKfQ1Nj-t2F4">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    // Get credentials from meta tags
    const SUPABASE_URL = document.querySelector('meta[name="supabase-url"]').content;
    const SUPABASE_ANON_KEY = document.querySelector('meta[name="supabase-key"]').content;
    
    // Check if credentials are set
    if (SUPABASE_URL === 'YOUR_SUPABASE_PROJECT_URL') {
      document.getElementById('root').innerHTML = `
        <div class="min-h-screen bg-gray-50 flex items-center justify-center p-4">
          <div class="bg-white rounded-lg shadow-lg p-8 max-w-md w-full">
            <h2 class="text-xl font-bold text-red-600 mb-4">Configuration Required</h2>
            <p class="text-gray-700 mb-4">Please update the Supabase credentials in this HTML file:</p>
            <ol class="list-decimal list-inside space-y-2 text-sm text-gray-600">
              <li>Open this HTML file in a text editor</li>
              <li>Find the meta tags at the top</li>
              <li>Replace YOUR_SUPABASE_PROJECT_URL with your actual URL</li>
              <li>Replace YOUR_SUPABASE_ANON_KEY with your actual key</li>
              <li>Save and refresh this page</li>
            </ol>
          </div>
        </div>
      `;
    } else {
      // Initialize Supabase
      const { createClient } = supabase;
      const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      
      // Map Lucide icons
      const {
        Phone, Users, CheckCircle, Activity, User, Building, Calendar, 
        TrendingUp, Clock, UserPlus, PhoneCall, Target, Award, Upload, 
        Download, FileDown, AlertCircle, Loader2, Search
      } = lucide;
      
      // Load the App component
      fetch('./App.jsx')
        .then(response => response.text())
        .then(appCode => {
          // Replace environment variables and module syntax
          const modifiedCode = appCode
            .replace(/import\s+React[^;]+;/g, '')
            .replace(/import\s+{[^}]+}\s+from\s+['"]lucide-react['"];/g, '')
            .replace(/import\s+{[^}]+}\s+from\s+['"]@supabase\/supabase-js['"];/g, '')
            .replace(/process\.env\.REACT_APP_SUPABASE_URL/g, `'${SUPABASE_URL}'`)
            .replace(/process\.env\.REACT_APP_SUPABASE_ANON_KEY/g, `'${SUPABASE_ANON_KEY}'`)
            .replace(/export\s+default\s+App;/g, '')
            .replace(/const supabase = createClient\([^)]+\);/g, 'const supabase = supabaseClient;');
          
          // Compile and run
          const compiledCode = Babel.transform(modifiedCode, { presets: ['react'] }).code;
          eval(compiledCode);
          
          // Mount the app
          const root = ReactDOM.createRoot(document.getElementById('root'));
          root.render(React.createElement(App));
        })
        .catch(error => {
          console.error('Error loading app:', error);
          document.getElementById('root').innerHTML = `
            <div class="min-h-screen bg-gray-50 flex items-center justify-center p-4">
              <div class="bg-white rounded-lg shadow-lg p-8 max-w-md w-full">
                <h2 class="text-xl font-bold text-red-600 mb-4">Error Loading Application</h2>
                <p class="text-gray-700">Make sure App.jsx is in the same directory as this HTML file.</p>
                <p class="text-sm text-gray-500 mt-2">Error: ${error.message}</p>
              </div>
            </div>
          `;
        });
    }
  </script>
</body>
</html>